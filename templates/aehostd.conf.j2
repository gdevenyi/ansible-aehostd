# Configuration for AE-DIR's custom NSS/PAM host demon
#
# {{ ansible_managed }}

[aehostd]

# The numeric user and group IDs to run as
uid = {{ aehostd_uid }}
gid = {{ aehostd_gid }}

# where process ID (PID) is stored
pidfile = {{ aehostd_pid_file }}

# pathname of Unix domain socket
socketpath = {{ aehostd_socket }}

# The location at which the LDAP server(s) should be reachable.
#uri = {{ ldap_uris|join(' ') }}
uri = ldapi://%2Fopt%2Fae-dir%2Frun%2Fslapd%2Fldapi

# preferred short bind-DN form (relocatable)
binddn = host={{ inventory_hostname }},{{ ldap_suffix }}
# pathname of file containing password for the above binddn
bindpwfile = {{ aehostd_pw_file }}

# TLS options
tls_cacertfile = {{ ldap_cacert_pathname }}

# local password changes not allowed
pam_passmod_deny_msg = Changing password on local system is not allowed for this user!

# Check the SSH client's hostname in user entry
pam_authz_search = {{ pam_authz_search }}

# cache TTL for the synchronous LDAP searches
cache_ttl = 5.0

# pathname for sudoers export
sudoers_file = /var/lib/aehostd/sudoers

# where to write SSH authorized keys
sshkeys_dir = {{ aehostd_sshkeys_dir }}
